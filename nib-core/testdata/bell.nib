// Rosetta code task: https://rosettacode.org/wiki/Bell_numbers

a ++ b = array.concat a b

bell 0 = [1]
bell n = out where
                previous = bell (n-1)
                first = array.ref previous (n-1)
                out = array.create (n+1)
                adders = [0] ++ previous
                go i acc | i == n+1 = ()
                go i acc = array.set out i (acc + array.ref adders i) & go (i+1) (acc + array.ref adders i)
                _ = go 0 first

_ = print (bell 14)
